{% extends "base.html" %}
{% load staticfiles %}
{% load filters %}
{% block script %}
    <script>
        $.getJSON('herramientas/api/categorias/').done(function (data) {
            $.each(data, function (i, item) {
                $("#categorias").append(
                    '<option value="' + item.pk + '">' + item.fields.nombre + '</option>'
                );
            })
        })
    </script>
{% endblock %}
{% block content %}


    <!-- Page Content -->

    <div class="container" style="margin-top: 5%">
        <h1 for="categorias">Realizar b√∫squeda</h1>
        <form method="get">
            <div class="row">
                {% if request.user|has_group:"MiembroGTI" or request.user|has_group:"MiembroConectate" %}
                <div class="form-group col-3" id="sel_categoria">

                        <label for="categorias">Categorias</label>
                        <select id="categorias" class="form-control" name="categoria">
                            <option value="">Todas las categorias</option>
                        </select>


                </div>
                   {% endif %}
                <div class="form-group col-3" id="sel_sistema_operativo">
                    <label for="sistema_operativo">Sistema operativo</label>
                    <input type="text" name="sistema_operativo" id="sistema_operativo" class="form-control" placeholder="Ejemplo: Windows">

                </div>
            </div>
        <button id="btnFiltrar" type="submit" class="btn btn-default" style="height: 40px;">Filtrar</button>

        </form>


    </div>
    <div class="container">

        <div class="row">

            {% for currentHerramienta in lista_herramientas %}
                {% if currentHerramienta.estado == 2 or request.user|has_group:"Administrador" or request.user|has_borrador_access:currentHerramienta or request.user|has_revision_access:currentHerramienta %}
                    <div class="col-sm-4 py-2">
                        <div class="card" style="height: 235px;">
                            <div class="card-header text-center"><a
                                    href="{% url 'tool_detail' currentHerramienta.id %}"> {{ currentHerramienta.nombre }}</a>
                            </div>
                            <div class="card-body">
                                <h6>{{ currentHerramienta.tipo }}</h6>
                                <hr/>
                                <p class="card-text">{{ currentHerramienta.descripcion|slice:"160" }}
                                        {% if currentHerramienta.descripcion|length > 160 %}...{% endif %}</p>
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}

        </div>
        <!-- /.row -->

        <div id="carouselExampleIndicators" class="carousel slide my-4" data-ride="carousel">
        </div>

    </div>
    <!-- /.container -->

{% endblock %}